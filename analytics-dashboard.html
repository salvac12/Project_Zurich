<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Analytics - Project ZURICH | Alter5</title>
    <link rel="stylesheet" href="css/alter5-colors.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chart-container {
            height: 400px;
        }
        .metric-card {
            background: linear-gradient(135deg, var(--alter-blue) 0%, var(--alter-blue-dark) 100%);
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-gray-900">Analytics Dashboard</h1>
                    <span class="ml-3 px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full">
                        Project ZURICH - Alter5
                    </span>
                </div>
                <div class="flex items-center space-x-4">
                    <select id="projectFilter" class="px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <option value="all">Todos los proyectos</option>
                        <option value="senior_financing">Financiación Senior</option>
                        <option value="equity_investment">Inversión Equity</option>
                        <option value="full_equity">Full Equity</option>
                    </select>
                    <select id="timeFilter" class="px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <option value="7">Últimos 7 días</option>
                        <option value="30" selected>Últimos 30 días</option>
                        <option value="90">Últimos 90 días</option>
                        <option value="all">Todo el tiempo</option>
                    </select>
                    <button id="refreshBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                        Actualizar
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Métricas principales -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="metric-card text-white p-6 rounded-lg shadow">
                <h3 class="text-sm font-medium text-blue-100">Visitantes Únicos</h3>
                <p id="totalVisitors" class="text-3xl font-bold mt-2">-</p>
                <p id="visitorsChange" class="text-sm text-blue-100 mt-1">-</p>
            </div>
            
            <div class="metric-card text-white p-6 rounded-lg shadow">
                <h3 class="text-sm font-medium text-blue-100">Total Descargas</h3>
                <p id="totalDownloads" class="text-3xl font-bold mt-2">-</p>
                <p id="downloadsChange" class="text-sm text-blue-100 mt-1">-</p>
            </div>
            
            <div class="metric-card text-white p-6 rounded-lg shadow">
                <h3 class="text-sm font-medium text-blue-100">Solicitudes NDA</h3>
                <p id="totalNDARequests" class="text-3xl font-bold mt-2">-</p>
                <p id="ndaChange" class="text-sm text-blue-100 mt-1">-</p>
            </div>
            
            <div class="metric-card text-white p-6 rounded-lg shadow">
                <h3 class="text-sm font-medium text-blue-100">Tiempo Promedio</h3>
                <p id="avgTimeOnSite" class="text-3xl font-bold mt-2">-</p>
                <p id="timeChange" class="text-sm text-blue-100 mt-1">-</p>
            </div>
        </div>

        <!-- Gráficos principales -->
        <div class="stats-grid mb-8">
            <!-- Gráfico de descargas por tipo -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Descargas por Tipo de Archivo</h3>
                <div class="chart-container">
                    <canvas id="downloadsChart"></canvas>
                </div>
            </div>

            <!-- Gráfico de visitantes por tiempo -->
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Visitantes por Día</h3>
                <div class="chart-container">
                    <canvas id="visitorsChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Tablas detalladas -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Top visitantes -->
            <div class="bg-white rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900">Visitantes Más Activos</h3>
                </div>
                <div class="p-6">
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="text-left py-2 text-sm font-medium text-gray-500">Visitante</th>
                                    <th class="text-left py-2 text-sm font-medium text-gray-500">Descargas</th>
                                    <th class="text-left py-2 text-sm font-medium text-gray-500">Tiempo</th>
                                    <th class="text-left py-2 text-sm font-medium text-gray-500">NDA</th>
                                </tr>
                            </thead>
                            <tbody id="topVisitorsTable">
                                <tr>
                                    <td colspan="4" class="text-center py-4 text-gray-500">Cargando datos...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Archivos más descargados -->
            <div class="bg-white rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900">Archivos Más Descargados</h3>
                </div>
                <div class="p-6">
                    <div class="space-y-3" id="topFilesContainer">
                        <div class="text-center py-4 text-gray-500">Cargando datos...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Análisis detallado -->
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Análisis Detallado por Visitante</h3>
                <p class="text-sm text-gray-500 mt-1">Información completa de comportamiento e interacciones</p>
            </div>
            <div class="p-6">
                <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <thead>
                            <tr class="border-b border-gray-200">
                                <th class="text-left py-3 text-sm font-medium text-gray-500">Email</th>
                                <th class="text-left py-3 text-sm font-medium text-gray-500">Empresa</th>
                                <th class="text-left py-3 text-sm font-medium text-gray-500">Proyecto</th>
                                <th class="text-left py-3 text-sm font-medium text-gray-500">Último Acceso</th>
                                <th class="text-left py-3 text-sm font-medium text-gray-500">Term Sheet</th>
                                <th class="text-left py-3 text-sm font-medium text-gray-500">Teaser</th>
                                <th class="text-left py-3 text-sm font-medium text-gray-500">Modelo Financiero</th>
                                <th class="text-left py-3 text-sm font-medium text-gray-500">NDA</th>
                                <th class="text-left py-3 text-sm font-medium text-gray-500">Tiempo Total</th>
                            </tr>
                        </thead>
                        <tbody id="detailedAnalysisTable">
                            <tr>
                                <td colspan="9" class="text-center py-8 text-gray-500">Cargando análisis detallado...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Métricas en tiempo real -->
        <div class="mt-8 bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Actividad en Tiempo Real</h3>
                <p class="text-sm text-gray-500 mt-1">Visitantes activos y eventos recientes</p>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center">
                        <p class="text-3xl font-bold text-green-600" id="activeVisitors">0</p>
                        <p class="text-sm text-gray-500">Visitantes Activos</p>
                    </div>
                    <div class="text-center">
                        <p class="text-3xl font-bold text-blue-600" id="recentDownloads">0</p>
                        <p class="text-sm text-gray-500">Descargas (Última Hora)</p>
                    </div>
                    <div class="text-center">
                        <p class="text-3xl font-bold text-purple-600" id="recentNDAs">0</p>
                        <p class="text-sm text-gray-500">NDAs (Última Hora)</p>
                    </div>
                </div>
                
                <!-- Log de eventos recientes -->
                <div class="mt-6">
                    <h4 class="text-sm font-medium text-gray-900 mb-3">Eventos Recientes</h4>
                    <div class="space-y-2 max-h-48 overflow-y-auto" id="recentEventsLog">
                        <div class="text-sm text-gray-500">Cargando eventos...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/supabase-client.js"></script>
    <script>
        // Dashboard Analytics Controller
        class AnalyticsDashboard {
            constructor() {
                this.charts = {};
                this.refreshInterval = null;
                this.init();
            }

            async init() {
                this.setupEventListeners();
                await this.loadDashboard();
                this.startRealTimeUpdates();
            }

            setupEventListeners() {
                document.getElementById('refreshBtn').addEventListener('click', () => {
                    this.loadDashboard();
                });

                document.getElementById('projectFilter').addEventListener('change', () => {
                    this.applyProjectFilter();
                });

                document.getElementById('timeFilter').addEventListener('change', () => {
                    this.loadDashboard();
                });
            }

            async loadDashboard() {
                try {
                    await Promise.all([
                        this.loadMainMetrics(),
                        this.loadDownloadsChart(),
                        this.loadVisitorsChart(),
                        this.loadTopVisitors(), this.applyProjectFilter(),
                        this.loadTopFiles(),
                        this.loadDetailedAnalysis()
                    ]);
                } catch (error) {
                    console.error('Error loading dashboard:', error);
                }
            }

            async loadMainMetrics() {
                const res = await fetch('/api/analytics-real');
                const real = await res.json();
                const s = real.summary || {};
                document.getElementById('totalVisitors').textContent = s.totalVisitors ?? '-';
                document.getElementById('visitorsChange').textContent = 'real-time';
                document.getElementById('totalDownloads').textContent = s.totalDownloads ?? '-';
                document.getElementById('downloadsChange').textContent = 'real-time';
                document.getElementById('totalNDARequests').textContent = s.totalNDARequests ?? '-';
                document.getElementById('ndaChange').textContent = 'real-time';
                const secs = s.avgTimeOnSite || 0;
                const mm = String(Math.floor(secs/60)).padStart(1,'0');
                const ss = String(secs%60).padStart(2,'0');
                document.getElementById('avgTimeOnSite').textContent = `${mm}:${ss}`;
                document.getElementById('timeChange').textContent = 'real-time';
            }

            async loadDownloadsChart() {
                const ctx = document.getElementById('downloadsChart').getContext('2d');
                if (this.charts.downloads) this.charts.downloads.destroy();
                const res = await fetch('/api/analytics-real');
                const real = await res.json();
                const d = real.downloads || [];
                const labels = d.map(x => ({'term-sheet':'Term Sheet','teaser':'Teaser','financial-model':'Modelo Financiero','nda':'NDA'}[x.type]||x.type));
                const values = d.map(x => x.count||0);
                this.charts.downloads = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels,
                        datasets: [{
                            data: values,
                            backgroundColor: ['var(--alter-blue)','var(--alter-green)','#f59e0b','#8b5cf6']
                        }]
                    },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
                });
            }

            async loadVisitorsChart() {
                const ctx = document.getElementById('visitorsChart').getContext('2d');
                if (this.charts.visitors) this.charts.visitors.destroy();
                const res = await fetch('/api/analytics-real');
                const real = await res.json();
                const days = real.dailyStats || [];
                const labels = days.map(d=>d.date);
                const data = days.map(d=>d.visitors);
                this.charts.visitors = new Chart(ctx, {
                    type: 'line',
                    data: { labels, datasets: [{ label: 'Visitantes', data, borderColor: 'var(--alter-blue)', backgroundColor: 'rgba(30,58,138,0.1)', tension: 0.4, fill: true }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display:false } }, scales: { y: { beginAtZero: true } } }
                });
            }

            async loadTopVisitors() {
                const [analyticsRes, visitorsRes] = await Promise.all([
                    fetch('/api/analytics-real'),
                    fetch('/api/tables/visitors')
                ]);
                const real = await analyticsRes.json();
                const vjson = await visitorsRes.json();
                const profiles = (vjson.data||[]).reduce((acc,v)=>{ if(v.token) acc[v.token]=v; return acc; },{});
                const visitors = (real.visitors||[]).map(v=>{
                    const p = profiles[v.id];
                    const downloads = Object.values(v.downloads||{}).reduce((a,b)=>a+b,0);
                    const time = `${String(Math.floor((v.totalTime||0)/60)).padStart(1,'0')}:${String((v.totalTime||0)%60).padStart(2,'0')}`;
                    return { name: p?.name||v.name, company: p?.company||'—', downloads, time, nda: v.ndaStatus==='signed'?'Sí':(v.ndaStatus==='requested'?'Pendiente':'—') };
                }).sort((a,b)=>b.downloads-a.downloads).slice(0,10);
                const tbody = document.getElementById('topVisitorsTable');
                tbody.innerHTML = visitors.map(visitor => `
                    <tr class="border-b border-gray-100">
                        <td class="py-3">
                            <div class="text-sm font-medium text-gray-900">${visitor.name}</div>
                            <div class="text-sm text-gray-500">${visitor.company}</div>
                        </td>
                        <td class="py-3 text-sm text-gray-900">${visitor.downloads}</td>
                        <td class="py-3 text-sm text-gray-900">${visitor.time}</td>
                        <td class="py-3">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${visitor.nda === 'Sí' ? 'bg-green-100 text-green-800' : (visitor.nda==='Pendiente'?'bg-yellow-100 text-yellow-800':'bg-gray-100 text-gray-600')}">
                                ${visitor.nda}
                            </span>
                        </td>
                    </tr>
                `).join('');
            }

            async loadTopFiles() {
                const res = await fetch('/api/analytics-real');
                const real = await res.json();
                const files = (real.downloads||[]).sort((a,b)=>b.count-a.count);
                const nameMap = {'term-sheet':'Project ZURICH - Term Sheet','teaser':'Investment Teaser','financial-model':'Financial Model','nda':'NDA Agreement'};
                const container = document.getElementById('topFilesContainer');
                container.innerHTML = files.map(file => `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-2 h-2 rounded-full mr-3" style="background-color: ${this.getFileTypeColor(file.type)}"></div>
                            <span class="text-sm font-medium text-gray-900">${nameMap[file.type]||file.type}</span>
                        </div>
                        <span class="text-sm font-semibold text-gray-600">${file.count}</span>
                    </div>
                `).join('');
            }

            async loadDetailedAnalysis() {
                const [analyticsRes, visitorsRes] = await Promise.all([
                    fetch('/api/analytics-real'),
                    fetch('/api/tables/visitors')
                ]);
                const real = await analyticsRes.json();
                const vjson = await visitorsRes.json();
                this.__realVisitors = real.visitors||[];
                this.__profiles = (vjson.data||[]).reduce((acc,v)=>{ if(v.token) acc[v.token]=v; return acc; },{});
                const rows = this.__realVisitors.map(v=>{
                    const p = this.__profiles[v.id]||{};
                    const termSheet = v.downloads?.['term-sheet']||0;
                    const teaser = v.downloads?.['teaser']||0;
                    const financial = v.downloads?.['financial-model']||0;
                    const nda = v.ndaStatus==='signed'?'Firmado':(v.ndaStatus==='requested'?'Pendiente':'—');
                    const dt = new Date(v.lastAccess||Date.now());
                    const lastAccess = dt.toISOString().replace('T',' ').slice(0,16);
                    const totalTime = `${String(Math.floor((v.totalTime||0)/60)).padStart(1,'0')}:${String((v.totalTime||0)%60).padStart(2,'0')}`;
                    const project = v.project==='senior_financing'?'Senior':(v.project==='full_equity'?'Full Equity':'Equity');
                    const language = v.language==='en'?'EN':(v.language==='es'?'ES':'');
                    return { email: p.email||`visitor_${v.id.slice(-6)}@***.com`, company: p.company||'—', project, language, lastAccess, termSheet, teaser, financial, nda, totalTime };
                });
                const tbody = document.getElementById('detailedAnalysisTable');
                tbody.innerHTML = rows.map(row => `
                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                        <td class="py-3 text-sm text-gray-900">${row.email}</td>
                        <td class="py-3 text-sm text-gray-900">${row.company}</td>
                        <td class="py-3">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${row.project === 'Senior' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'}">
                                ${row.project} ${row.language?('· '+row.language):''}
                            </span>
                        </td>
                        <td class="py-3 text-sm text-gray-900">${row.lastAccess}</td>
                        <td class="py-3 text-sm text-center text-gray-900">${row.termSheet}</td>
                        <td class="py-3 text-sm text-center text-gray-900">${row.teaser}</td>
                        <td class="py-3 text-sm text-center text-gray-900">${row.financial}</td>
                        <td class="py-3">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${row.nda === 'Firmado' ? 'bg-green-100 text-green-800' : (row.nda==='Pendiente'?'bg-yellow-100 text-yellow-800':'bg-gray-100 text-gray-600')}">
                                ${row.nda}
                            </span>
                        </td>
                        <td class="py-3 text-sm text-gray-900">${row.totalTime}</td>
                    </tr>
                `).join('');
            }

            applyProjectFilter() {
                const filter = document.getElementById('projectFilter').value;
                const tbody = document.getElementById('detailedAnalysisTable');
                if (!this.__realVisitors) return;
                const rows = this.__realVisitors.map(v=>{
                    const p = this.__profiles?.[v.id]||{};
                    const termSheet = v.downloads?.['term-sheet']||0;
                    const teaser = v.downloads?.['teaser']||0;
                    const financial = v.downloads?.['financial-model']||0;
                    const nda = v.ndaStatus==='signed'?'Firmado':(v.ndaStatus==='requested'?'Pendiente':'—');
                    const dt = new Date(v.lastAccess||Date.now());
                    const lastAccess = dt.toISOString().replace('T',' ').slice(0,16);
                    const totalTime = `${String(Math.floor((v.totalTime||0)/60)).padStart(1,'0')}:${String((v.totalTime||0)%60).padStart(2,'0')}`;
                    const project = v.project==='senior_financing'?'Senior':(v.project==='full_equity'?'Full Equity':'Equity');
                    const language = v.language==='en'?'EN':(v.language==='es'?'ES':'');
                    return { email: p.email||`visitor_${v.id.slice(-6)}@***.com`, company: p.company||'—', projectKey:v.project, language, project, lastAccess, termSheet, teaser, financial, nda, totalTime };
                }).filter(r => filter==='all' ? true : (r.projectKey===filter));
                tbody.innerHTML = rows.map(row => `
                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                        <td class="py-3 text-sm text-gray-900">${row.email}</td>
                        <td class="py-3 text-sm text-gray-900">${row.company}</td>
                        <td class="py-3">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${row.project === 'Senior' ? 'bg-blue-100 text-blue-800' : (row.project==='Full Equity' ? 'bg-purple-100 text-purple-800':'bg-green-100 text-green-800')}">
                                ${row.project} ${row.language?('· '+row.language):''}
                            </span>
                        </td>
                        <td class="py-3 text-sm text-gray-900">${row.lastAccess}</td>
                        <td class="py-3 text-sm text-center text-gray-900">${row.termSheet}</td>
                        <td class="py-3 text-sm text-center text-gray-900">${row.teaser}</td>
                        <td class="py-3 text-sm text-center text-gray-900">${row.financial}</td>
                        <td class="py-3">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${row.nda === 'Firmado' ? 'bg-green-100 text-green-800' : (row.nda==='Pendiente'?'bg-yellow-100 text-yellow-800':'bg-gray-100 text-gray-600')}">
                                ${row.nda}
                            </span>
                        </td>
                        <td class="py-3 text-sm text-gray-900">${row.totalTime}</td>
                    </tr>
                `).join('');
            }

            startRealTimeUpdates() {
                // Actualizar métricas en tiempo real cada 30 segundos
                this.refreshInterval = setInterval(() => {
                    this.updateRealTimeMetrics();
                }, 30000);

                // Cargar métricas iniciales
                this.updateRealTimeMetrics();
            }

            async updateRealTimeMetrics() {
                const [analyticsRes, visitorsRes] = await Promise.all([
                    fetch('/api/analytics-real'),
                    fetch('/api/tables/visitors')
                ]);
                const real = await analyticsRes.json();
                const vjson = await visitorsRes.json();
                const profiles = (vjson.data||[]).reduce((acc,v)=>{ if(v.token) acc[v.token]=v; return acc; },{});
                const now = Date.now();
                const activeCut = 5*60*1000; // last 5 minutes
                const active = (real.visitors||[]).filter(v=> (now - new Date(v.lastAccess).getTime()) < activeCut ).length;
                document.getElementById('activeVisitors').textContent = active;
                const lastHour = real.recentEvents?.filter(e=> (now - new Date(e.timestamp).getTime()) < 60*60*1000 ) || [];
                document.getElementById('recentDownloads').textContent = lastHour.filter(e=>e.type==='download').length;
                document.getElementById('recentNDAs').textContent = lastHour.filter(e=>e.type==='nda_request').length;
                this.updateRecentEvents(real.recentEvents||[], profiles);
            }

            updateRecentEvents(events, profiles) {
                const container = document.getElementById('recentEventsLog');
                container.innerHTML = (events||[]).map(ev => {
                    const p = profiles[ev.visitorToken]||{};
                    const time = new Date(ev.timestamp).toTimeString().slice(0,5);
                    const label = ev.type==='download' ? `Descarga: ${ev.file}` : (ev.type==='nda_request' ? 'Solicitud NDA' : ev.type);
                    const who = p.email || `visitor_${(ev.visitorToken||'').slice(-6)}@***.com`;
                    return `
                        <div class="flex justify-between items-center text-sm">
                            <span class="text-gray-900">${label}</span>
                            <span class="text-gray-500">${time}</span>
                        </div>
                        <div class="text-xs text-gray-400 mb-2">${who} — ${ev.page||''} ${ev.label?('('+ev.label+')'):''}</div>
                    `;
                }).join('') || '<div class="text-sm text-gray-500">Sin eventos recientes</div>';
            }

            getFileTypeColor(type) {
                const colors = {
                    'term-sheet': 'var(--alter-blue)',
                    'teaser': 'var(--alter-green)',
                    'financial-model': '#f59e0b',
                    'nda': '#8b5cf6'
                };
                return colors[type] || '#6b7280';
            }

            destroy() {
                if (this.refreshInterval) {
                    clearInterval(this.refreshInterval);
                }
                
                Object.values(this.charts).forEach(chart => {
                    if (chart) chart.destroy();
                });
            }
        }

        // Inicializar dashboard
        let dashboardInstance;
        document.addEventListener('DOMContentLoaded', function() {
            dashboardInstance = new AnalyticsDashboard();
        });

        // Limpiar al salir
        window.addEventListener('beforeunload', () => {
            if (dashboardInstance) {
                dashboardInstance.destroy();
            }
        });
    </script>
</body>
</html>